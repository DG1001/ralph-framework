# ü§ñ Ralph Framework

Universal autonomous development framework powered by Claude Code. Describe your project in `plan.md`, Ralph builds it completely autonomously.

## ‚ú® Features

- üéØ **Three-Phase Development**: Spec ‚Üí Implement ‚Üí Refine
- üß† **Self-Selecting Models**: Intelligently switches between Haiku (fast) and Sonnet (complex)
- ü§ñ **Subagent Support**: Optional parallel workers for 5-10x faster execution
- üìã **Autonomous Planning**: Generates detailed specs from high-level descriptions
- üîÑ **Continuous Development**: Works through tasks until completion
- üìä **Progress Tracking**: Real-time monitoring and decision history
- üéõÔ∏è **Flexible**: Works with any project type and tech stack

## üöÄ Quick Start

### 1. Clone and Setup
```bash
# Clone this repository as your project base
git clone https://github.com/your-username/ralph-framework.git my-awesome-project
cd my-awesome-project

# Update remote for your project
git remote remove origin
git remote add origin https://github.com/your-username/my-awesome-project.git

# Make scripts executable
chmod +x ralph.sh tools/*.sh
```

### 2. Prerequisites

Install Claude Code:
```bash
npm install -g @anthropic-ai/claude-code
```

Requirements:
- Claude Code installed
- Claude Pro subscription (recommended) or API key
- Git

### 3. Create Your Project Plan
```bash
# Copy template and edit
cp plan.md.template plan.md
nano plan.md  # or your favorite editor
```

**Example plan.md:**
```markdown
# Project Plan

## Project Name
Task Master Pro

## Description
A modern task management app with team collaboration features

## Core Features
- User authentication and profiles
- Create, edit, delete tasks
- Organize tasks in projects
- Team collaboration and sharing
- Due dates and reminders
- Priority levels
- Tags and filtering

## Technology Preferences
- Backend: Python with Flask or FastAPI
- Frontend: React
- Database: PostgreSQL
```

### 4. Start Ralph
```bash
# Generate specifications
./ralph.sh

# Review generated specs in specs/ and fix_plan.md
# Then continue with implementation
./ralph.sh

# Or skip review and go straight to implementation
./ralph.sh --skip-review
```

### 5. Monitor Progress (Optional)

In a separate terminal:
```bash
./tools/monitor.sh
```

### 6. Refinement (After Implementation Complete)
```bash
# Analyze codebase for improvements
./ralph.sh --refine

# Implement refinements
./ralph.sh
```

## üìÅ Project Structure

After initialization:
```
your-project/
‚îú‚îÄ‚îÄ ralph.sh                    # Main automation script
‚îú‚îÄ‚îÄ plan.md                     # Your project description
‚îú‚îÄ‚îÄ subagents.json             # Subagent configuration (optional)
‚îÇ
‚îú‚îÄ‚îÄ fix_plan.md                 # TODO list (generated by Ralph)
‚îú‚îÄ‚îÄ specs/                      # Specifications (generated by Ralph)
‚îÇ   ‚îú‚îÄ‚îÄ feature1.md
‚îÇ   ‚îú‚îÄ‚îÄ feature2.md
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ src/                        # Source code (generated by Ralph)
‚îú‚îÄ‚îÄ tests/                      # Tests (generated by Ralph)
‚îÇ
‚îú‚îÄ‚îÄ CLAUDE.md                   # Context for Claude
‚îú‚îÄ‚îÄ AGENT.md                    # Build/run/test instructions
‚îú‚îÄ‚îÄ CODER_ENV.md                # Environment-specific instructions (optional)
‚îÇ
‚îú‚îÄ‚îÄ .ralph/                     # Ralph's runtime state
‚îÇ   ‚îú‚îÄ‚îÄ phase.txt              # Current phase
‚îÇ   ‚îú‚îÄ‚îÄ next_model.txt         # Model for next loop
‚îÇ   ‚îú‚îÄ‚îÄ model_reason.txt       # Why that model was chosen
‚îÇ   ‚îî‚îÄ‚îÄ decision_history.log   # All model decisions
‚îÇ
‚îî‚îÄ‚îÄ tools/                      # Monitoring and analysis tools
    ‚îú‚îÄ‚îÄ monitor.sh
    ‚îî‚îÄ‚îÄ analyze.sh
```

## üéØ How It Works

### Phase 0: Specification Generation

1. You create `plan.md` with your project idea
2. Ralph (using Sonnet) reads it and generates:
   - Detailed specifications in `specs/`
   - Implementation plan in `fix_plan.md`
   - Project documentation
3. Script pauses for you to review
4. You can adjust specs if needed

### Phase 1: Implementation

1. Ralph works through `fix_plan.md` autonomously
2. For each task:
   - Searches codebase (avoid duplication)
   - Implements feature fully (no placeholders)
   - Writes and runs tests
   - Updates documentation
   - Commits to git
   - **Decides next model** (Haiku or Sonnet)
3. Self-selects between:
   - **Haiku** (80-90%): Fast, efficient for standard tasks
   - **Sonnet** (10-20%): Smart, for complex/critical tasks
4. Stops when all TODOs complete

### Phase 2: Refinement

1. Run with `--refine` flag
2. Ralph analyzes entire codebase
3. Identifies improvements:
   - Security vulnerabilities
   - Performance issues
   - Code quality improvements
   - Missing features
   - Documentation gaps
4. Creates new prioritized TODO list
5. Run `./ralph.sh` again to implement refinements

## ü§ñ Subagents (Optional but Recommended)

Ralph can use specialized subagents for **5-10x faster execution** and better context management.

### What are Subagents?

Subagents are specialized AI workers that handle specific tasks in parallel:

| Subagent | Role | Model | Parallel? |
|----------|------|-------|-----------|
| **searcher** | Finds code in codebase | Haiku | ‚úÖ Yes (5-10x) |
| **tester** | Runs tests and analyzes results | Haiku | ‚ùå No (1 at a time) |
| **reviewer** | Reviews code quality | Sonnet | ‚ùå No (1 at a time) |
| **documenter** | Updates documentation | Haiku | ‚úÖ Yes (2-5x) |
| **spec_writer** | Writes specifications | Sonnet | ‚úÖ Yes (5-10x) |

### Benefits

**Without Subagents:**
- Primary context does everything
- Sequential operations
- Context window fills quickly
- Slower for large codebases

**With Subagents:**
- Primary context = Scheduler
- Subagents = Workers
- Parallel searching (5-10x faster)
- Tests in isolated context
- Cleaner primary context

### Enabling Subagents

Subagents are **automatically enabled** if `subagents.json` exists in your project root.

The file is included in this repository, so subagents work out of the box!

### Disabling Subagents

If you want to run without subagents:
```bash
# Temporarily disable
mv subagents.json subagents.json.disabled

# Run Ralph
./ralph.sh

# Re-enable
mv subagents.json.disabled subagents.json
```

### Subagent Configuration

The `subagents.json` file defines all available subagents:
```json
{
  "searcher": {
    "description": "Finds code in codebase",
    "prompt": "Search thoroughly using grep, ripgrep, and file inspection...",
    "tools": ["Read", "Grep", "Glob", "Bash"],
    "model": "haiku"
  },
  "tester": {
    "description": "Runs tests and analyzes results",
    "prompt": "Run tests and provide clear summaries...",
    "tools": ["Read", "Bash"],
    "model": "haiku"
  },
  ...
}
```

You can customize these or add your own subagents!

### Parallelism Strategy

Ralph follows these rules:

‚úÖ **Run in Parallel** (fast, safe):
- Multiple **searcher** subagents (5-10 simultaneously)
- Multiple **documenter** subagents (2-5 simultaneously)

‚ö†Ô∏è **Run Sequentially** (prevent issues):
- Only **1 tester** at a time (prevents backpressure)
- Only **1 reviewer** at a time (expensive)

## üéÆ Commands
```bash
# Start Ralph (generate specs or continue implementation)
./ralph.sh

# Skip spec review, go directly to implementation
./ralph.sh --skip-review

# Refinement mode (after implementation complete)
./ralph.sh --refine

# Show help
./ralph.sh --help

# Monitor progress (separate terminal)
./tools/monitor.sh

# Analyze model decisions
./tools/analyze.sh
```

## üß† Model Selection Strategy

Ralph intelligently selects the optimal model for each task:

### Haiku (Default - Fast & Efficient)

**Used for ~80-90% of tasks:**
- CRUD operations
- Forms and validation
- UI components
- Simple API endpoints
- Standard database queries
- Bug fixes
- Writing tests
- Documentation updates

**Why?** Fast, cost-effective, handles routine work excellently.

### Sonnet (Complex Tasks)

**Used for ~10-20% of tasks:**
- Initial project setup
- Database schema design
- Authentication systems
- Security implementations
- Complex business logic
- API architecture
- Performance optimization
- Critical code reviews

**Why?** More capable for complex reasoning and critical decisions.

### Self-Selection

At the end of each loop, Ralph **analyzes the next task** and decides:
- Reads next item from `fix_plan.md`
- Evaluates complexity
- Writes decision to `.ralph/next_model.txt`
- Documents reasoning in `.ralph/model_reason.txt`

**Example decision:**
```
# .ralph/next_model.txt
haiku

# .ralph/model_reason.txt
Next task: Create user profile form - standard CRUD operation, 
follows existing patterns in codebase
```

You can review all decisions in `.ralph/decision_history.log`

## üìä Monitoring and Analysis

### Real-time Monitoring
```bash
./tools/monitor.sh
```

Shows:
- Current phase
- Next model decision
- Progress percentage
- Recent commits
- Upcoming tasks

### Decision Analysis
```bash
./tools/analyze.sh
```

Shows:
- Model usage statistics
- Common reasons for Sonnet selection
- Recent decisions
- Overall efficiency

### Subagent Monitoring (if enabled)
```bash
./tools/monitor_subagents.sh
```

Shows subagent activity and parallel operations.

## üîß Advanced Usage

### Interrupting and Resuming

Ralph can be interrupted anytime:
```bash
# Interrupt
Ctrl+C

# Resume later
./ralph.sh  # Continues where it left off
```

State is saved automatically.

### Custom Subagents

Add your own subagents to `subagents.json`:
```json
{
  "api_tester": {
    "description": "Tests API endpoints",
    "prompt": "Test API endpoints thoroughly, check status codes, response formats...",
    "tools": ["Bash", "Read"],
    "model": "haiku"
  }
}
```

### Manual Phase Control

Override phase if needed:
```bash
# Force back to implementation
echo "1" > .ralph/phase.txt
./ralph.sh

# Force refinement mode
echo "1-complete" > .ralph/phase.txt
./ralph.sh --refine
```

## üìù Example Projects

### Example 1: Blog Platform
```markdown
# plan.md

## Project Name
DevBlog

## Description
Personal blog platform with markdown support

## Core Features
- Write posts in Markdown
- Syntax highlighting for code
- Categories and tags
- Comments
- RSS feed
- Search

## Technology Preferences
- Backend: Node.js with Express
- Frontend: Simple HTML/CSS/JS
- Database: SQLite
```

### Example 2: Inventory Management
```markdown
# plan.md

## Project Name
StockMaster

## Description
Inventory management system for small businesses

## Core Features
- Product catalog with photos
- Stock tracking (in/out)
- Low stock alerts
- Barcode scanning
- Sales reporting
- Supplier management
- Multi-location support

## Technology Preferences
- Backend: Python with Django
- Frontend: React
- Database: PostgreSQL
```

### Example 3: API Service
```markdown
# plan.md

## Project Name
Weather Aggregator API

## Description
RESTful API that aggregates weather data from multiple sources

## Core Features
- Fetch from multiple weather APIs
- Cache results
- Rate limiting
- API key authentication
- Historical data storage
- JSON response format
- OpenAPI documentation

## Technology Preferences
- Python with FastAPI
- Redis for caching
- PostgreSQL for historical data
```

## üéØ Best Practices

### Writing Good plan.md Files

‚úÖ **Do:**
- Be specific about core features
- Mention any critical requirements
- Include inspiration/similar projects if helpful
- Specify tech preferences if you have them

‚ùå **Don't:**
- Write implementation details (Ralph figures that out)
- Be too vague ("make a website")
- Over-specify everything (trust Ralph)

### During Development

‚úÖ **Do:**
- Review generated specs before implementation
- Let Ralph finish its tasks
- Monitor progress periodically
- Review commits occasionally

‚ùå **Don't:**
- Edit files while Ralph is running
- Rush through spec review
- Interrupt unnecessarily
- Micromanage every decision

### After Implementation

‚úÖ **Do:**
- Test the application thoroughly
- Run refinement analysis
- Review code quality
- Check security aspects

## üêõ Troubleshooting

### Ralph Gets Stuck
```bash
# Check current state
cat .ralph/phase.txt
cat fix_plan.md

# Reset to implementation phase
echo "1" > .ralph/phase.txt
./ralph.sh
```

### Model Decision Not Made

Ralph should decide next model automatically. If not:
```bash
# Manually set to haiku
echo "haiku" > .ralph/next_model.txt
echo "Manual override" > .ralph/model_reason.txt
```

### Subagents Not Working
```bash
# Check if file exists
ls -la subagents.json

# Validate JSON
cat subagents.json | jq .

# Check Claude Code supports subagents
claude --version
```

### Tests Failing in Loop

Ralph will attempt to fix failing tests. If stuck:
1. Review the test output
2. Check `.ralph/decision_history.log`
3. Manually fix if needed
4. Commit and continue

### Out of Context

If Ralph runs out of context:
1. It will automatically compact
2. Or commit current work and continue
3. Subagents help prevent this!

## üìñ Documentation

### File Reference

- **`plan.md`**: Your project description (you create)
- **`fix_plan.md`**: TODO list (Ralph generates and maintains)
- **`specs/`**: Detailed specifications (Ralph generates)
- **`CLAUDE.md`**: Persistent context (Ralph maintains)
- **`AGENT.md`**: Build/test instructions (Ralph maintains)
- **`CODER_ENV.md`**: Environment-specific instructions (optional, see below)
- **`subagents.json`**: Subagent configuration (included)

### Phase Files

- **`.ralph/phase.txt`**: Current phase (0, 0-complete, 1, 1-complete, 2)
- **`.ralph/next_model.txt`**: Next model to use (haiku or sonnet)
- **`.ralph/model_reason.txt`**: Why that model was chosen
- **`.ralph/decision_history.log`**: All model decisions with timestamps

### CODER_ENV.md - Environment Context (Optional)

The `CODER_ENV.md` file provides environment-specific instructions for AI agents (Claude) when working in specialized development environments.

**When to use:**
- ‚úÖ **XaresAICoder environment**: Running in a containerized cloud IDE with subdomain port proxying
- ‚úÖ **Custom cloud IDE setups**: Browser-based VS Code with specific networking requirements
- ‚úÖ **Specialized deployment environments**: Non-standard service binding or port access patterns
- ‚úÖ **Team environments**: Shared infrastructure with specific configuration needs

**When NOT to use:**
- ‚ùå **Standard local development**: Regular desktop IDE with localhost development
- ‚ùå **Simple projects**: No backend services or special networking requirements
- ‚ùå **Default configurations**: When standard setup instructions in AGENT.md are sufficient

**What it contains:**
- Environment overview (e.g., Docker containerization, cloud IDE)
- Critical binding requirements (e.g., must bind to 0.0.0.0 instead of localhost)
- Port proxying patterns (e.g., subdomain-based routing)
- Package installation permissions and requirements
- Cross-service communication patterns
- Frontend-to-backend URL construction
- Deployment-specific considerations

**Example use case:**

If your project runs in XaresAICoder:
```bash
# CODER_ENV.md tells Ralph/Claude:
# - Services MUST bind to 0.0.0.0 (not localhost)
# - Ports are accessible via [projectid]-[port].domain
# - Sudo access is available for system packages
# - Frontend apps need dynamic backend URL construction
```

**How Ralph uses it:**

Ralph automatically includes CODER_ENV.md in the context (via CLAUDE.md reference) so that:
1. During spec generation, environment constraints are considered
2. During implementation, services are configured correctly
3. Test commands use proper URLs and binding
4. Documentation reflects environment-specific setup

**When to create it:**

Create CODER_ENV.md before running Ralph if:
- You're using XaresAICoder or similar cloud IDE
- Your environment has non-standard networking
- Services need specific binding or URL patterns
- You want to avoid Ralph making incorrect assumptions about localhost development

**How it works with AGENT.md:**
- **AGENT.md**: Project-specific build/test commands (e.g., "npm start", "pytest")
- **CODER_ENV.md**: Environment-specific configuration (e.g., "bind to 0.0.0.0", "use subdomain URLs")

Ralph combines both to generate correct commands for your specific environment.

## üîí Security & Privacy

- All code runs locally
- Claude Code accesses only your project directory
- No code is sent anywhere except Anthropic's API
- Credentials/secrets should be in `.env` (gitignored)
- Review generated code before deploying

## üí° Tips for Success

1. **Start Small**: Begin with clear, focused projects
2. **Good Specs**: Take time to review generated specs
3. **Let It Work**: Avoid interrupting Ralph mid-task
4. **Use Subagents**: They make Ralph much faster
5. **Monitor Progress**: Check in periodically
6. **Trust the Process**: Ralph learns and improves each loop
7. **Refine Later**: Don't expect perfection in Phase 1
8. **Review Code**: Always review before deploying

## ü§ù Contributing

Contributions welcome! Areas for improvement:
- Additional subagent types
- Better monitoring tools
- Support for more project types
- Improved prompts
- Bug fixes

## üìÑ License

MIT License - See LICENSE file

## üôè Credits

- Inspired by [Geoffrey Huntley's Ralph technique](https://ghuntley.com/ralph/)
- Built on [Claude Code](https://claude.ai/code) by Anthropic
- Uses Claude Haiku 4.5 and Sonnet 4.5 models

## üÜò Support

Having issues?

1. Check troubleshooting section above
2. Review `.ralph/decision_history.log`
3. Check Claude Code documentation: https://docs.claude.com/claude-code
4. Open an issue on GitHub

## üó∫Ô∏è Roadmap

Future enhancements:
- [ ] Web UI for monitoring
- [ ] Multiple project support
- [ ] Cloud deployment automation
- [ ] Team collaboration features
- [ ] Integration with project management tools
- [ ] Custom prompt templates
- [ ] Plugin system

---

**Ready to build something amazing? Create your `plan.md` and let Ralph do the rest!** üöÄ